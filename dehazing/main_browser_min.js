(function(){function S(H,T,V){function F(Q,G){if(!T[Q]){if(!H[Q]){var J="function"==typeof require&&require;if(!G&&J)return J(Q,!0);if(N)return N(Q,!0);var K=new Error("Cannot find module '"+Q+"'");throw K.code="MODULE_NOT_FOUND",K}var X=T[Q]={exports:{}};H[Q][0].call(X.exports,function(Y){var $=H[Q][1][Y];return F($||Y)},X,X.exports,S,H,T,V)}return T[Q].exports}for(var N="function"==typeof require&&require,O=0;O<V.length;O++)F(V[O]);return F}return S})()({1:[function(S,H){H.exports=function(){var F,N,O=[];this.init=void(F=navigator.hardwareConcurrency||4),this.getCores=function(){return F},this.resample_auto=function(Q,G,J,K,X){var Y=this.getCores();window.Worker&&1<Y?this.resample(Q,G,J,K,X):(this.resample_single(Q,G,J,!0),void 0!=X&&X())},this.resize_image=function(Q,G,J,K,X){var Y=document.getElementById(Q),$=document.createElement("canvas");if($.width=Y.width,$.height=Y.height,$.getContext("2d").drawImage(Y,0,0),void 0==G&&void 0==J&&void 0!=K&&(G=Y.width/100*K,J=Y.height/100*K),void 0==J){var ee=Y.width/G;J=Y.height/ee}G=Math.round(G),J=Math.round(J);var te=function(){var ie=$.toDataURL();Y.width=G,Y.height=J,Y.src=ie,ie=null,$=null};void 0==X||1==X?this.resample($,G,J,!0,te):(this.resample_single($,G,J,!0),te())},this.resample=function(Q,G,J,K,X){var Y=Q.width,$=Q.height;G=Math.round(G);var ee=$/(J=Math.round(J));if(0<O.length)for(ye=0;ye<F;ye++)void 0!=O[ye]&&(O[ye].terminate(),delete O[ye]);O=Array(F);for(var xe,te=Q.getContext("2d"),ie=[],ne=2*Math.ceil($/F/2),ae=-1,ye=0;ye<F;ye++)if(xe=ae+1,!(xe>=$)){ae=xe+ne-1,ae=Math.min(ae,$-1);var ze=ne;ze=Math.min(ne,$-xe),ie[ye]={},ie[ye].source=te.getImageData(0,xe,Y,ne),ie[ye].target=!0,ie[ye].start_y=Math.ceil(xe/ee),ie[ye].height=ze}!0===K?(Q.width=G,Q.height=J):te.clearRect(0,0,Y,$);for(var re=0,ye=0;ye<F;ye++)if(void 0!=ie[ye].target){re++;var oe=new Worker(N);O[ye]=oe,oe.onmessage=function(le){re--;var de=le.data.core;O[de].terminate(),delete O[de];var ge=Math.ceil(ie[de].height/ee);ie[de].target=te.createImageData(G,ge),ie[de].target.data.set(le.data.target),te.putImageData(ie[de].target,0,ie[de].start_y),0>=re&&void 0!=X&&X()};var se={width_source:Y,height_source:ie[ye].height,width:G,height:Math.ceil(ie[ye].height/ee),core:ye,source:ie[ye].source.data.buffer};oe.postMessage(se,[se.source])}},N=window.URL.createObjectURL(new Blob(["(",function(){onmessage=function(Q){for(var G=Q.data.core,J=Q.data.width_source,K=Q.data.height_source,X=Q.data.width,Y=Q.data.height,$=J/X,ee=K/Y,te=Math.ceil($/2),ie=Math.ceil(ee/2),ne=new Uint8ClampedArray(Q.data.source),ae=(ne.length,4*(X*Y)),ye=new ArrayBuffer(ae),xe=new Uint8ClampedArray(ye,0,ae),ze=0;ze<Y;ze++)for(var re=0;re<X;re++){var oe=4*(re+ze*X),se=0,le=0,de=0,ge=0,he=0,pe=0,ue=0,me=ze*ee,ce=Math.floor(re*$),fe=Math.ceil((re+1)*$),be=Math.floor(ze*ee),we=Math.ceil((ze+1)*ee);fe=Math.min(fe,J),we=Math.min(we,K);for(var Ie=be;Ie<we;Ie++)for(var ve=Math.abs(me-Ie)/ie,ke=re*$,Ee=ce;Ee<fe;Ee++){var je=Math.abs(ke-Ee)/te,Be=Math.sqrt(ve*ve+je*je);if(!(1<=Be)){var Le=4*(Ee+Ie*J);ue+=(se=2*Be*Be*Be-3*Be*Be+1)*ne[Le+3],de+=se,255>ne[Le+3]&&(se=se*ne[Le+3]/250),ge+=se*ne[Le],he+=se*ne[Le+1],pe+=se*ne[Le+2],le+=se}}xe[oe]=ge/le,xe[oe+1]=he/le,xe[oe+2]=pe/le,xe[oe+3]=ue/de}postMessage({core:G,target:xe},[xe.buffer])}}.toString(),")()"],{type:"application/javascript"})),this.resample_single=function(Q,G,J,K){for(var X=Q.width,Y=Q.height,$=X/(G=Math.round(G)),ee=Y/(J=Math.round(J)),te=Math.ceil($/2),ie=Math.ceil(ee/2),ne=Q.getContext("2d"),ae=ne.getImageData(0,0,X,Y),ye=ne.createImageData(G,J),xe=ae.data,ze=ye.data,re=0;re<J;re++)for(var oe=0;oe<G;oe++){var se=4*(oe+re*G),le=0,de=0,ge=0,he=0,pe=0,ue=0,me=0,ce=re*ee,fe=Math.floor(oe*$),be=Math.ceil((oe+1)*$),we=Math.floor(re*ee),Ie=Math.ceil((re+1)*ee);be=Math.min(be,X),Ie=Math.min(Ie,Y);for(var ve=we;ve<Ie;ve++)for(var ke=Math.abs(ce-ve)/ie,_e=oe*$,je=fe;je<be;je++){var Be=Math.abs(_e-je)/te,Le=Math.sqrt(ke*ke+Be*Be);if(!(1<=Le)){var De=4*(je+ve*X);me+=(le=2*Le*Le*Le-3*Le*Le+1)*xe[De+3],ge+=le,255>xe[De+3]&&(le=le*xe[De+3]/250),he+=le*xe[De],pe+=le*xe[De+1],ue+=le*xe[De+2],de+=le}}ze[se]=he/de,ze[se+1]=pe/de,ze[se+2]=ue/de,ze[se+3]=me/ge}!0===K?(Q.width=G,Q.height=J):ne.clearRect(0,0,X,Y),ne.putImageData(ye,0,0)}}},{}],2:[function(S,H){function F(K,X,Y,$,ee,te,ie){for(var ne=te.length,ye=new Uint32Array($.length*ee.length*ne).fill(0),xe=new Uint8ClampedArray($.length*ee.length*ne).fill(0),ze=0;ze<K.length;ze+=3){var re=$.findIndex(Be=>Be>K[ze+X]),oe=ee.findIndex(Be=>Be>K[ze+Y]);if(!(0>re||0>oe)){xe.fill(0);for(var se=re;se<$.length;++se)for(var le=oe;le<ee.length;++le){var de=$[se],ge=ee[le],he=de-K[ze+X],pe=ge-K[ze+Y],ue=Math.sqrt(he*he+pe*pe),ce=Math.acos(he/ue),fe=Math.round(2*(ce/Math.PI)*ne);fe==ne&&fe--;var be=(se*ee.length+le)*ne+fe;xe[be]=1;for(var we=0;we<ne;++we){var Ie=Math.abs((de-K[ze+X])*te[2*we]-(ge-K[ze+Y])*te[2*we+1]),ve=Ie<2*0.05*(ue*Math.SQRT1_2+1)?1:0,be=(se*ee.length+le)*ne+we;xe[be]=ve}}for(se=0;se<ye.length;++se)ye[se]+=xe[se]}}for(var ke=new Float32Array($.length*ee.length*ne).fill(0),se=0;se<ye.length;++se)if(!(1>=ye[se]))for(var _e=Math.floor(se/ne),de=$[Math.floor(_e/ee.length)],ge=ee[_e%ee.length],le=0;le<K.length;le+=3){var he=de-K[le+X],pe=ge-K[le+Y],ue=Math.sqrt(he*he+pe*pe),Ee=ie[le/3]*Math.exp(5*-ue+1);ke[se]+=Ee}for(var je=new Float32Array($.length*ee.length).fill(0),se=0;se<je.length;++se)for(var le=0;le<ne;++le)je[se]+=ke[se*ne+le];return je}var N=S("./utils.js"),O=N.arange,Q=N.linRange,G=N.cartesian,J=N.range;H.exports=function(K,X,Y,$){var ee=$-Y,te=0;te=0.6<ee?0.05:0.2<ee?0.03:0.02;for(var ie=X.quantizeID(K),ne=new Float32Array(X.n_clusters).fill(0),ae=0;ae<ie.length;++ae)ne[ie[ae]]++;var ye=ne.reduce((Le,De)=>Le+De);ne=ne.map(Le=>Le/ye);for(var xe=new Float32Array(X.centroids.slice(0)),ae=0;ae<xe.length;++ae)xe[ae]/=255;for(var ze=O(Y,te,$),re=O(Y,te,$),oe=O(Y,te,$),se=Q(0,25,Math.PI/2),le=new Float32Array(50),ae=0;25>ae;ae++)le[2*ae]=Math.sin(se[ae]),le[2*ae+1]=Math.cos(se[ae]);for(var de=F(xe,0,1,ze,re,le,ne),ge=F(xe,1,2,re,oe,le,ne),he=F(xe,0,2,ze,oe,le,ne),pe=new Float32Array(ze.length*re.length*oe.length),ae=0;ae<ze.length;++ae)for(var ue=0;ue<re.length;++ue)for(var me=0;me<oe.length;++me){var ce=ae*(re.length*oe.length)+ue*oe.length+me,fe=ae*re.length+ue,be=ue*oe.length+me,we=ae*oe.length+me;pe[ce]=de[fe]*ge[be]*he[we]}for(var Ie=pe.indexOf(Math.max(...pe)),ve=Math.floor(Ie/(re.length*oe.length)),ke=Math.floor(Ie/oe.length)%re.length,_e=Ie%oe.length,Ee=[,,,].fill(0),je=0,ae=Math.max(ve-1,0);ae<Math.min(ve+2,ze.length);++ae)for(var ue=Math.max(ke-1,0);ue<Math.min(ke+2,re.length);++ue)for(var me=Math.max(_e-1,0);me<Math.min(_e+2,oe.length);++me){var Ie=ae*re.length*oe.length+ue*oe.length+me,Be=pe[Ie];je+=Be,Ee[0]+=ze[ae]*Be,Ee[1]+=re[ue]*Be,Ee[2]+=oe[me]*Be}return Ee=Ee.map(Le=>Le/je),Ee}},{"./utils.js":9}],3:[function(S,H){function Q(ae,ye,xe,ze){var re=new Number(document.getElementById("hazeAmountSlide").value),oe=new Number(document.getElementById("distSlide").value),se=new Number(document.getElementById("gammaOutSlide").value),le=Math.pow(2,oe);window.dehazeFlat=G(ae,xe,ze,le),J(window.dehazeFlat,ae.width,ae.height,ye,xe,ze,re),window.dehazedCanvas=ie(ye),Y(window.dehazedCanvas,ye,1/se)}function G(ae,ye,xe,ze){var re=ae.getContext("2d").getImageData(0,0,ae.width,ae.height).data,oe=new Uint8ClampedArray(4*ye.length).fill(255);return ye.forEach((se,le)=>{var de=se*ze;oe[4*le]=(re[4*le]-255*((1-de)*xe[0]))/(de+1e-4),oe[4*le+1]=(re[4*le+1]-255*((1-de)*xe[1]))/(de+1e-4),oe[4*le+2]=(re[4*le+2]-255*((1-de)*xe[2]))/(de+1e-4)}),oe}function J(ae,ye,xe,ze,re,oe,se){for(var ge,le=new Uint8ClampedArray(ae.length).fill(255),de=0;de<re.length;de++)ge=Math.pow(re[de],se),le[4*de]=ge*ae[4*de]+255*((1-ge)*oe[0]),le[4*de+1]=ge*ae[4*de+1]+255*((1-ge)*oe[1]),le[4*de+2]=ge*ae[4*de+2]+255*((1-ge)*oe[2]);ze.width=ye,ze.height=xe;var he=ze.getContext("2d"),pe=he.createImageData(ye,xe);pe.data.set(le),he.putImageData(pe,0,0)}function K(ae,ye,xe,ze){var re=ae.getContext("2d"),oe=new Uint8ClampedArray(4*ye.length);ye.forEach((le,de)=>{oe[4*de]=255*le,oe[4*de+1]=255*le,oe[4*de+2]=255*le,oe[4*de+3]=255}),ae.width=xe,ae.height=ze;var se=re.createImageData(ae.width,ae.height);se.data.set(oe),re.putImageData(se,0,0)}function Y(ae,ye,xe){for(var ze=ye.getContext("2d"),re=ae.getContext("2d").getImageData(0,0,ye.width,ye.height).data,oe=new Uint8ClampedArray(re.length).fill(255),se=0;se<re.length;se+=4)oe[se]=255*Math.pow(re[se]/255,xe),oe[se+1]=255*Math.pow(re[se+1]/255,xe),oe[se+2]=255*Math.pow(re[se+2]/255,xe);var le=ze.createImageData(ye.width,ye.height);le.data.set(oe),ze.putImageData(le,0,0)}var ee=S("./Hermite-resize/dist/hermite.npm.js"),te=S("./utils.js"),ie=te.cloneCanvas,ne=S("webworkify");H.exports.processImage=function(ae){var ye=new Number(document.getElementById("gammaSlide").value),xe=document.getElementById("originalPic"),ze=xe.getContext("2d");xe.width=ae.width,xe.height=ae.height,ze.drawImage(ae,0,0),window.origNonResize=ie(xe);var re=1,oe=600;ae.width>oe&&(re=oe/ae.width),ae.height*re>oe&&(re=oe/ae.height);var se=new ee;se.resample(xe,Math.round(ae.width*re),Math.round(ae.height*re),!0,function(){window.origCanvas=ie(xe),Y(window.origCanvas,xe,ye),xe.style.visibility="visible"})},H.exports.sliderChange=function(ae,ye){ye.innerHTML=ae.value},H.exports.changeGamma=Y,H.exports.dehazePreview=function(){var ae=new Date,ye=document.getElementById("originalPic"),xe=new Number(document.getElementById("minAirSlide").value),ze=new Number(document.getElementById("maxAirSlide").value),re=ye.getContext("2d"),oe=re.getImageData(0,0,ye.width,ye.height).data.slice(0),se=ye.width,le=ye.height,de=document.getElementById("statusUpdate"),ge=Array.from(document.getElementsByClassName("loading"));ge.forEach(pe=>pe.style.visibility="visible");var he=ne(S("../workers/dehazer_worker.js"));he.onmessage=function(pe){if("finish"===pe.data.signal){window.airLight=pe.data.airLight;var ue=document.getElementById("airLightPreview"),me=window.airLight.map(Ie=>Math.round(255*Ie)),ce="rgb("+me[0]+","+me[1]+","+me[2]+")";ue.style.backgroundColor=ce,window.transmittance=pe.data.transmittance;var fe=new Date;console.log("Finished transmittance map in "+(fe-ae)/1e3+" secs."),de.innerHTML="Post processing\u2026";var be=document.getElementById("transmittanceResultsPic");K(be,window.transmittance,ye.width,ye.height);var we=document.getElementById("dehazeResult");Q(ye,we,window.transmittance,window.airLight),ge.forEach(Ie=>Ie.style.visibility="hidden"),document.getElementById("transmittanceDiv").style.visibility="visible"}else de.innerHTML=pe.data.signal},he.postMessage({image:oe,clusters:500,minEst:xe,maxEst:ze,picWidth:se,picHeight:le},[oe.buffer])},H.exports.findAirLight=function(){var ae=document.getElementById("originalPic"),ye=new Number(document.getElementById("minAirSlide").value),xe=new Number(document.getElementById("maxAirSlide").value),ze=ae.getContext("2d"),re=ze.getImageData(0,0,ae.width,ae.height).data.slice(0),oe=ne(S("../workers/kdtree_worker.js"));oe.onmessage=function(se){window.airLight=se.data;var le=document.getElementById("airLightPreview"),de=se.data.map(he=>Math.round(255*he)),ge="rgb("+de[0]+","+de[1]+","+de[2]+")";le.style.backgroundColor=ge},oe.postMessage({image:re,clusters:500,minEst:ye,maxEst:xe},[re.buffer])},H.exports.findAndDrawResults=function(){var ae=document.getElementById("originalPic"),ye=ae.getContext("2d"),xe=ae.width,ze=ae.height,re=ye.getImageData(0,0,xe,ze).data,oe=new Date,se=ne(S("../workers/transmittance_worker.js"));se.onmessage=function(le){window.transmittance=le.data;var de=new Date;console.log("Finished transmittance map in "+(de-oe)/1e3+" secs.");var ge=document.getElementById("transmittanceResultsPic");K(ge,window.transmittance,ae.width,ae.height);var he=document.getElementById("dehazeResult");Q(ae,he,window.transmittance,window.airLight)},se.postMessage({colorArray:re,picWidth:xe,picHeight:ze,airLight:window.airLight},[re.buffer])},H.exports.drawDehazed=Q,H.exports.mixHaze=J,H.exports.calculateOriginal=function(){var ae=document.getElementById("gammaSlide").value;Y(window.origNonResize,window.origNonResize,ae);var ye=new Date,xe=window.origNonResize.getContext("2d"),ze=window.origNonResize.width,re=window.origNonResize.height,oe=xe.getImageData(0,0,ze,re).data,se=document.getElementById("statusUpdate"),le=Array.from(document.getElementsByClassName("loading"));le.forEach(ge=>ge.style.visibility="visible");var de=ne(S("../workers/transmittance_worker.js"));de.onmessage=function(ge){if("finish"===ge.data.signal){var he=ge.data.transmittance,pe=new Date;console.log("Finished transmittance map in "+(pe-ye)/1e3+" secs.");var ue=document.createElement("canvas");Q(window.origNonResize,ue,he,window.airLight),console.log(ue.width);var me=document.getElementById("downloadLink");ue.toBlob(function(fe){me.href=URL.createObjectURL(fe)});var ce=function(){requestAnimationFrame(function(){URL.revokeObjectURL(this.href),this.href=null}),this.removeEventListener("click",ce)};me.addEventListener("click",ce),me.download="dehazed.png",le.forEach(fe=>fe.style.visibility="hidden"),document.getElementById("transmittanceDiv").style.visibility="visible"}else se.innerHTML=ge.data.signal},de.postMessage({colorArray:oe,picWidth:ze,picHeight:re,airLight:window.airLight},[oe.buffer])}},{"../workers/dehazer_worker.js":12,"../workers/kdtree_worker.js":13,"../workers/transmittance_worker.js":14,"./Hermite-resize/dist/hermite.npm.js":1,"./utils.js":9,webworkify:11}],4:[function(S,H,T){(function(V){(function(F){if("object"==typeof T&&"undefined"!=typeof H)H.exports=F();else if("function"==typeof define&&define.amd)define([],F);else{var N;N="undefined"==typeof window?"undefined"==typeof V?"undefined"==typeof self?this:self:V:window,N.PriorityQueue=F()}})(function(){return function Q(G,J,K){function X(ee,te){if(!J[ee]){if(!G[ee]){var ie="function"==typeof S&&S;if(!te&&ie)return ie(ee,!0);if(Y)return Y(ee,!0);var ne=new Error("Cannot find module '"+ee+"'");throw ne.code="MODULE_NOT_FOUND",ne}var ae=J[ee]={exports:{}};G[ee][0].call(ae.exports,function(ye){var xe=G[ee][1][ye];return X(xe?xe:ye)},ae,ae.exports,Q,G,J,K)}return J[ee].exports}for(var Y="function"==typeof S&&S,$=0;$<K.length;$++)X(K[$]);return X}({1:[function(Q,G){var K,X,Y,$,ee,te=function(ne,ae){function ye(){this.constructor=ne}for(var xe in ae)ie.call(ae,xe)&&(ne[xe]=ae[xe]);return ye.prototype=ae.prototype,ne.prototype=new ye,ne.__super__=ae.prototype,ne},ie={}.hasOwnProperty;K=Q("./PriorityQueue/AbstractPriorityQueue"),X=Q("./PriorityQueue/ArrayStrategy"),$=Q("./PriorityQueue/BinaryHeapStrategy"),Y=Q("./PriorityQueue/BHeapStrategy"),ee=function(ne){function ae(ye){ye||(ye={}),ye.strategy||(ye.strategy=$),ye.comparator||(ye.comparator=function(xe,ze){return(xe||0)-(ze||0)}),ae.__super__.constructor.call(this,ye)}return te(ae,ne),ae}(K),ee.ArrayStrategy=X,ee.BinaryHeapStrategy=$,ee.BHeapStrategy=Y,G.exports=ee},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(Q,G){var K;G.exports=K=function(){function X(Y){var $;if(null==(null==Y?void 0:Y.strategy))throw"Must pass options.strategy, a strategy";if(null==(null==Y?void 0:Y.comparator))throw"Must pass options.comparator, a comparator";this.priv=new Y.strategy(Y),this.length=(null==Y||null==($=Y.initialValues)?void 0:$.length)||0}return X.prototype.queue=function(Y){return this.length++,this.priv.queue(Y),void 0},X.prototype.dequeue=function(){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},X.prototype.peek=function(){if(!this.length)throw"Empty queue";return this.priv.peek()},X.prototype.clear=function(){return this.length=0,this.priv.clear()},X}()},{}],3:[function(Q,G){var K,X;X=function(Y,$,ee){var te,ie,ne;for(ie=0,te=Y.length;ie<te;)ne=ie+te>>>1,0<=ee(Y[ne],$)?ie=ne+1:te=ne;return ie},G.exports=K=function(){function Y($){var ee;this.options=$,this.comparator=this.options.comparator,this.data=(null==(ee=this.options.initialValues)?void 0:ee.slice(0))||[],this.data.sort(this.comparator).reverse()}return Y.prototype.queue=function($){var ee;return ee=X(this.data,$,this.comparator),this.data.splice(ee,0,$),void 0},Y.prototype.dequeue=function(){return this.data.pop()},Y.prototype.peek=function(){return this.data[this.data.length-1]},Y.prototype.clear=function(){return this.data.length=0,void 0},Y}()},{}],4:[function(Q,G){var K;G.exports=K=function(){function X(Y){var $,ee,te,ie,ne,ae,ye,xe,ze;for(this.comparator=(null==Y?void 0:Y.comparator)||function(re,oe){return re-oe},this.pageSize=(null==Y?void 0:Y.pageSize)||512,this.length=0,xe=0;1<<xe<this.pageSize;)xe+=1;if(1<<xe!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=xe,this._emptyMemoryPageTemplate=$=[],(ee=te=0,ae=this.pageSize);0<=ae?te<ae:te>ae;ee=0<=ae?++te:--te)$.push(null);if(this._memory=[],this._mask=this.pageSize-1,Y.initialValues)for(ye=Y.initialValues,ie=0,ne=ye.length;ie<ne;ie++)ze=ye[ie],this.queue(ze)}return X.prototype.queue=function(Y){return this.length+=1,this._write(this.length,Y),this._bubbleUp(this.length,Y),void 0},X.prototype.dequeue=function(){var Y,$;return Y=this._read(1),$=this._read(this.length),this.length-=1,0<this.length&&(this._write(1,$),this._bubbleDown(1,$)),Y},X.prototype.peek=function(){return this._read(1)},X.prototype.clear=function(){return this.length=0,this._memory.length=0,void 0},X.prototype._write=function(Y,$){var ee;for(ee=Y>>this._shift;ee>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[ee][Y&this._mask]=$},X.prototype._read=function(Y){return this._memory[Y>>this._shift][Y&this._mask]},X.prototype._bubbleUp=function(Y,$){var ee,te,ie,ne;for(ee=this.comparator;1<Y&&(te=Y&this._mask,Y<this.pageSize||3<te?ie=Y&~this._mask|te>>1:2>te?(ie=Y-this.pageSize>>this._shift,ie+=ie&~(this._mask>>1),ie|=this.pageSize>>1):ie=Y-2,ne=this._read(ie),!(0>ee(ne,$)));)this._write(ie,$),this._write(Y,ne),Y=ie},X.prototype._bubbleDown=function(Y,$){var ee,te,ie,ne,ae;for(ae=this.comparator;Y<this.length;)if(Y>this._mask&&!(Y&this._mask-1)?ee=te=Y+2:Y&this.pageSize>>1?(ee=(Y&~this._mask)>>1,ee|=Y&this._mask>>1,ee=ee+1<<this._shift,te=ee+1):(ee=Y+(Y&this._mask),te=ee+1),ee!==te&&te<=this.length){if(ie=this._read(ee),ne=this._read(te),0>ae(ie,$)&&0>=ae(ie,ne))this._write(ee,$),this._write(Y,ie),Y=ee;else if(0>ae(ne,$))this._write(te,$),this._write(Y,ne),Y=te;else break;}else if(!(ee<=this.length))break;else if(ie=this._read(ee),0>ae(ie,$))this._write(ee,$),this._write(Y,ie),Y=ee;else break},X}()},{}],5:[function(Q,G){var K;G.exports=K=function(){function X(Y){var $;this.comparator=(null==Y?void 0:Y.comparator)||function(ee,te){return ee-te},this.length=0,this.data=(null==($=Y.initialValues)?void 0:$.slice(0))||[],this._heapify()}return X.prototype._heapify=function(){var Y,$,ee;if(0<this.data.length)for(Y=$=1,ee=this.data.length;1<=ee?$<ee:$>ee;Y=1<=ee?++$:--$)this._bubbleUp(Y)},X.prototype.queue=function(Y){return this.data.push(Y),this._bubbleUp(this.data.length-1),void 0},X.prototype.dequeue=function(){var Y,$;return $=this.data[0],Y=this.data.pop(),0<this.data.length&&(this.data[0]=Y,this._bubbleDown(0)),$},X.prototype.peek=function(){return this.data[0]},X.prototype.clear=function(){return this.length=0,this.data.length=0,void 0},X.prototype._bubbleUp=function(Y){for(var $,ee;0<Y&&($=Y-1>>>1,0>this.comparator(this.data[Y],this.data[$]));)ee=this.data[$],this.data[$]=this.data[Y],this.data[Y]=ee,Y=$},X.prototype._bubbleDown=function(Y){var $,ee,te,ie,ne;for($=this.data.length-1;ee=(Y<<1)+1,ie=ee+1,te=Y,ee<=$&&0>this.comparator(this.data[ee],this.data[te])&&(te=ee),ie<=$&&0>this.comparator(this.data[ie],this.data[te])&&(te=ie),te!==Y;)ne=this.data[te],this.data[te]=this.data[Y],this.data[Y]=ne,Y=te},X}()},{}]},{},[1])(1)})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],5:[function(S,H,T){(function(V,F){"function"==typeof define&&define.amd?define(["exports"],F):"object"==typeof T?F(T):F(V)})(this,function(V){function F(Q,G,J){this.obj=Q,this.left=null,this.right=null,this.parent=J,this.dimension=G}function O(Q){this.content=[],this.scoreFunction=Q}O.prototype={push:function(Q){this.content.push(Q),this.bubbleUp(this.content.length-1)},pop:function(){var Q=this.content[0],G=this.content.pop();return 0<this.content.length&&(this.content[0]=G,this.sinkDown(0)),Q},peek:function(){return this.content[0]},remove:function(Q){for(var G=this.content.length,J=0;J<G;J++)if(this.content[J]==Q){var K=this.content.pop();return void(J!=G-1&&(this.content[J]=K,this.scoreFunction(K)<this.scoreFunction(Q)?this.bubbleUp(J):this.sinkDown(J)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(Q){for(var G=this.content[Q];0<Q;){var J=Math.floor((Q+1)/2)-1,K=this.content[J];if(this.scoreFunction(G)<this.scoreFunction(K))this.content[J]=G,this.content[Q]=K,Q=J;else break}},sinkDown:function(Q){for(var G=this.content.length,J=this.content[Q],K=this.scoreFunction(J);;){var X=2*(Q+1),Y=X-1,$=null;if(Y<G){var ee=this.content[Y],te=this.scoreFunction(ee);te<K&&($=Y)}if(X<G){var ie=this.content[X],ne=this.scoreFunction(ie);ne<(null==$?K:te)&&($=X)}if(null!=$)this.content[Q]=this.content[$],this.content[$]=J,Q=$;else break}}},V.kdTree=function(Q,G,J){function K($,ee,te){var ne,ae,ie=ee%J.length;return 0===$.length?null:1===$.length?new F($[0],ie,te):($.sort(function(ye,xe){return ye[J[ie]]-xe[J[ie]]}),ne=Math.floor($.length/2),ae=new F($[ne],ie,te),ae.left=K($.slice(0,ne),ee+1,ae),ae.right=K($.slice(ne+1),ee+1,ae),ae)}var Y=this;Array.isArray(Q)?this.root=K(Q,0,null):function($){function ee(te){te.left&&(te.left.parent=te,ee(te.left)),te.right&&(te.right.parent=te,ee(te.right))}Y.root=$,ee(Y.root)}(Q,G,J),this.toJSON=function($){$||($=this.root);var ee=new F($.obj,$.dimension,null);return $.left&&(ee.left=Y.toJSON($.left)),$.right&&(ee.right=Y.toJSON($.right)),ee},this.insert=function($){function ee(ae,ye){if(null===ae)return ye;var xe=J[ae.dimension];return $[xe]<ae.obj[xe]?ee(ae.left,ae):ee(ae.right,ae)}var ie,ne,te=ee(this.root,null);return null===te?void(this.root=new F($,0,null)):void(ie=new F($,(te.dimension+1)%J.length,te),ne=J[te.dimension],$[ne]<te.obj[ne]?te.left=ie:te.right=ie)},this.remove=function($){function ee(ne){if(null===ne)return null;if(ne.obj===$)return ne;var ae=J[ne.dimension];return $[ae]<ne.obj[ae]?ee(ne.left,ne):ee(ne.right,ne)}function te(ne){function ae(re,oe){var se,le,de,ge,he;return null===re?null:(se=J[oe],re.dimension===oe)?null===re.left?re:ae(re.left,oe):(le=re.obj[se],de=ae(re.left,oe),ge=ae(re.right,oe),he=re,null!==de&&de.obj[se]<le&&(he=de),null!==ge&&ge.obj[se]<he.obj[se]&&(he=ge),he)}var ye,xe,ze;return null===ne.left&&null===ne.right?null===ne.parent?void(Y.root=null):(ze=J[ne.parent.dimension],void(ne.obj[ze]<ne.parent.obj[ze]?ne.parent.left=null:ne.parent.right=null)):void(null===ne.right?(ye=ae(ne.left,ne.dimension),xe=ye.obj,te(ye),ne.right=ne.left,ne.left=null,ne.obj=xe):(ye=ae(ne.right,ne.dimension),xe=ye.obj,te(ye),ne.obj=xe))}var ie=ee(Y.root);null===ie||te(ie)},this.nearest=function($,ee,te){function ie(xe){function ze(pe,ue){ye.push([pe,ue]),ye.size()>ee&&ye.pop()}var re,de,ge,he,oe=J[xe.dimension],se=G($,xe.obj),le={};for(he=0;he<J.length;he+=1)le[J[he]]=he===xe.dimension?$[J[he]]:xe.obj[J[he]];return de=G(le,xe.obj),null===xe.right&&null===xe.left?void((ye.size()<ee||se<ye.peek()[1])&&ze(xe,se)):void(re=null===xe.right?xe.left:null===xe.left?xe.right:$[oe]<xe.obj[oe]?xe.left:xe.right,ie(re),(ye.size()<ee||se<ye.peek()[1])&&ze(xe,se),(ye.size()<ee||Math.abs(de)<ye.peek()[1])&&(ge=re===xe.left?xe.right:xe.left,null!==ge&&ie(ge)))}var ne,ae,ye;if(ye=new O(function(xe){return-xe[1]}),te)for(ne=0;ne<ee;ne+=1)ye.push([null,te]);for(Y.root&&ie(Y.root),ae=[],ne=0;ne<Math.min(ee,ye.content.length);ne+=1)ye.content[ne][0]&&ae.push([ye.content[ne][0].obj,ye.content[ne][1]]);return ae},this.balanceFactor=function(){function $(te){return null===te?0:Math.max($(te.left),$(te.right))+1}function ee(te){return null===te?0:ee(te.left)+ee(te.right)+1}return $(Y.root)/(Math.log(ee(Y.root))/Math.log(2))}},V.BinaryHeap=O})},{}],6:[function(S,H){function V(O,Q,G,J,K,X){this.minVal=J.slice(0),this.maxVal=K.slice(0),this.startIdx=Q,this.endIdx=G,this.splitChannel=-1,this.splitThreshold=-1,this.splitVariance=-1,this.left=-1,this.right=-1,this.parent=X,this.isLeaf=!0,this.index=-1;for(var $,Y=0;3>Y;Y++){$=new Uint32Array(256).fill(0);for(var ee=this.startIdx;ee<this.endIdx;++ee)$[O[4*ee+Y]]++;for(var te=0,ie=0,ne=$.map((oe,se)=>oe*se).reduce((oe,se)=>oe+se,0),ae=$.reduce((oe,se)=>oe+se,0),ee=0;256>ee;++ee){ie+=$[ee];var ye=ae-ie;if(0!=ie&&0!=ye){te+=ee*$[ee];var xe=(ne-te)/ye,ze=te/ie-xe,re=ie*ye*ze*ze;re>=this.splitVariance&&(this.splitChannel=Y,this.splitThreshold=ee,this.splitVariance=re)}}}}function F(O,Q){var G=new N({comparator:function(he,pe){return pe.splitVariance-he.splitVariance}});G.queue(new V(O,0,O.length/4,[0,0,0],[255,255,252],-1)),console.log("ha"),this.kdtree=Array(2*Q-1);for(var X,J=0,K=0;0<G.length&&K+G.length<Q;){if(X=G.dequeue(),0<=X.parent){var Y=this.kdtree[X.parent];Y.minVal.every((he,pe)=>he===X.minVal[pe])?Y.left=J:Y.right=J}if(this.kdtree[J]=X,-1==X.splitChannel){J++,K++;continue}for(var $=X.splitChannel,ee=X.splitThreshold,te=X.startIdx-1,ie=X.startIdx,ie=X.startIdx;ie<X.endIdx;++ie)if(O[4*ie+$]<ee){te++;for(var xe,ne=4*te,ae=4*ie,ye=0;4>ye;++ye)xe=O[ae+ye],O[ae+ye]=O[ne+ye],O[ne+ye]=xe}var ze=te+1;if(ze==X.startIdx||ze==X.endIdx){J++,K++;continue}var re=X.maxVal.slice(0);re[$]=ee,G.queue(new V(O,X.startIdx,ze,X.minVal,re,J)),re=X.minVal.slice(0),re[$]=ee+1,G.queue(new V(O,ze,X.endIdx,re,X.maxVal,J)),this.kdtree[J].isLeaf=!1,J++}for(;0<G.length;){var X=G.dequeue();if(0<=X.parent){var Y=this.kdtree[X.parent];Y.minVal.every((he,pe)=>he===X.minVal[pe])?Y.left=J:Y.right=J}this.kdtree[J]=X,J++}var oe=0;this.centroids=new Uint8ClampedArray(3*Q),this.n_clusters=Q;for(var se=0;se<J;++se)if(this.kdtree[se].isLeaf){this.kdtree[se].index=oe;for(var le=this.kdtree[se],de=[0,0,0],ye=4*le.startIdx;ye<4*le.endIdx;ye+=4)de[0]+=O[ye],de[1]+=O[ye+1],de[2]+=O[ye+2];var ge=le.endIdx-le.startIdx;this.centroids[3*oe]=Math.round(de[0]/ge),this.centroids[3*oe+1]=Math.round(de[1]/ge),this.centroids[3*oe+2]=Math.round(de[2]/ge),le.centroid=this.centroids.slice(3*oe,3*oe+3),oe++}}var N=S("./js-priority-queue/priority-queue.js");F.prototype.lookupColor=function(O){for(var G,Q=this.kdtree[0];!Q.isLeaf;)G=Q.splitChannel,Q=O[G]<Q.splitThreshold?this.kdtree[Q.left]:this.kdtree[Q.right];return Q.centroid.slice(0)},F.prototype.lookupID=function(O){for(var G,Q=this.kdtree[0];!Q.isLeaf;)G=Q.splitChannel,Q=O[G]<Q.splitThreshold?this.kdtree[Q.left]:this.kdtree[Q.right];return Q.index},F.prototype.quantizeID=function(O){var Q=new Uint16Array(O.length/4);for(i=0;i<O.length/4;i++)Q[i]=this.lookupID(O.slice(4*i,4*i+3));return Q},H.exports=F},{"./js-priority-queue/priority-queue.js":4}],7:[function(S,H){var V=S("./utils.js"),F=S("./kd-tree-javascript/kdTree.js");kd_tree_sample_points=[{x:0,y:-1,z:0},{x:0.723607,y:-0.44722,z:0.525725},{x:-0.276388,y:-0.44722,z:0.850649},{x:-0.894426,y:-0.447216,z:0},{x:-0.276388,y:-0.44722,z:-0.850649},{x:0.723607,y:-0.44722,z:-0.525725},{x:0.276388,y:0.44722,z:0.850649},{x:-0.723607,y:0.44722,z:0.525725},{x:-0.723607,y:0.44722,z:-0.525725},{x:0.276388,y:0.44722,z:-0.850649},{x:0.894426,y:0.447216,z:0},{x:0,y:1,z:0},{x:-0.257937,y:-0.550685,z:0.79386},{x:-0.232822,y:-0.657519,z:0.716563},{x:-0.200688,y:-0.760403,z:0.617666},{x:-0.162456,y:-0.850654,z:0.499995},{x:-0.120413,y:-0.920955,z:0.370598},{x:-0.077607,y:-0.96795,z:0.238853},{x:-0.036848,y:-0.992865,z:0.113408},{x:0.096471,y:-0.992865,z:0.070089},{x:0.203181,y:-0.96795,z:0.147618},{x:0.315251,y:-0.920955,z:0.22904},{x:0.425323,y:-0.850654,z:0.309011},{x:0.52542,y:-0.760403,z:0.381735},{x:0.609547,y:-0.657519,z:0.442856},{x:0.6753,y:-0.550685,z:0.490628},{x:0.638452,y:-0.476987,z:0.604038},{x:0.531941,y:-0.502302,z:0.681712},{x:0.405008,y:-0.519572,z:0.752338},{x:0.262869,y:-0.525738,z:0.809012},{x:0.114564,y:-0.519572,z:0.846711},{x:-0.029639,y:-0.502302,z:0.864184},{x:-0.161465,y:-0.476988,z:0.863951},{x:0.771771,y:-0.476987,z:-0.420539},{x:0.812729,y:-0.502301,z:-0.295238},{x:0.840673,y:-0.519571,z:-0.152694},{x:0.850648,y:-0.525736,z:0},{x:0.840673,y:-0.519571,z:0.152694},{x:0.812729,y:-0.502301,z:0.295238},{x:0.771771,y:-0.476987,z:0.420539},{x:0.096471,y:-0.992865,z:-0.070089},{x:0.203181,y:-0.96795,z:-0.147618},{x:0.315251,y:-0.920955,z:-0.22904},{x:0.425323,y:-0.850654,z:-0.309011},{x:0.52542,y:-0.760403,z:-0.381735},{x:0.609547,y:-0.657519,z:-0.442856},{x:0.6753,y:-0.550685,z:-0.490628},{x:-0.834716,y:-0.550681,z:0},{x:-0.753442,y:-0.657515,z:0},{x:-0.649456,y:-0.760399,z:0},{x:-0.52573,y:-0.850652,z:0},{x:-0.389673,y:-0.920953,z:0},{x:-0.251147,y:-0.967949,z:0},{x:-0.119245,y:-0.992865,z:0},{x:-0.377183,y:-0.476988,z:0.793861},{x:-0.483971,y:-0.502302,z:0.716565},{x:-0.590366,y:-0.519572,z:0.617668},{x:-0.688189,y:-0.525736,z:0.499997},{x:-0.769872,y:-0.51957,z:0.3706},{x:-0.831051,y:-0.502299,z:0.238853},{x:-0.871565,y:-0.476984,z:0.113408},{x:-0.257937,y:-0.550685,z:-0.79386},{x:-0.232822,y:-0.657519,z:-0.716563},{x:-0.200688,y:-0.760403,z:-0.617666},{x:-0.162456,y:-0.850654,z:-0.499995},{x:-0.120413,y:-0.920955,z:-0.370598},{x:-0.077607,y:-0.96795,z:-0.238853},{x:-0.036848,y:-0.992865,z:-0.113408},{x:-0.871565,y:-0.476984,z:-0.113408},{x:-0.831051,y:-0.502299,z:-0.238853},{x:-0.769872,y:-0.51957,z:-0.3706},{x:-0.688189,y:-0.525736,z:-0.499997},{x:-0.590366,y:-0.519572,z:-0.617668},{x:-0.483971,y:-0.502302,z:-0.716565},{x:-0.377183,y:-0.476988,z:-0.793861},{x:-0.161465,y:-0.476988,z:-0.863951},{x:-0.029639,y:-0.502302,z:-0.864184},{x:0.114564,y:-0.519573,z:-0.846711},{x:0.262869,y:-0.525738,z:-0.809012},{x:0.405008,y:-0.519572,z:-0.752338},{x:0.531941,y:-0.502302,z:-0.681712},{x:0.638453,y:-0.476987,z:-0.604038},{x:0.931188,y:0.357738,z:0.070089},{x:0.956626,y:0.251149,z:0.147618},{x:0.964711,y:0.129893,z:0.229041},{x:0.951058,y:-0,z:0.309013},{x:0.915098,y:-0.129893,z:0.381737},{x:0.860698,y:-0.251151,z:0.442858},{x:0.794547,y:-0.357741,z:0.490629},{x:0.794547,y:-0.357741,z:-0.490629},{x:0.860698,y:-0.251151,z:-0.442858},{x:0.915098,y:-0.129893,z:-0.381737},{x:0.951058,y:0,z:-0.309013},{x:0.964711,y:0.129893,z:-0.229041},{x:0.956626,y:0.251149,z:-0.147618},{x:0.931188,y:0.357738,z:-0.070089},{x:0.221089,y:0.357741,z:0.907271},{x:0.155215,y:0.251152,z:0.955422},{x:0.080276,y:0.129894,z:0.988273},{x:-0,y:-0,z:1},{x:-0.080276,y:-0.129894,z:0.988273},{x:-0.155215,y:-0.251152,z:0.955422},{x:-0.221089,y:-0.357741,z:0.907271},{x:0.71215,y:-0.357741,z:0.604039},{x:0.687159,y:-0.251152,z:0.681715},{x:0.645839,y:-0.129894,z:0.752343},{x:0.587786,y:0,z:0.809017},{x:0.515946,y:0.129894,z:0.846716},{x:0.436007,y:0.251152,z:0.864188},{x:0.354409,y:0.357742,z:0.863953},{x:-0.794547,y:0.357741,z:0.490629},{x:-0.860698,y:0.251151,z:0.442858},{x:-0.915098,y:0.129893,z:0.381737},{x:-0.951058,y:-0,z:0.309013},{x:-0.964711,y:-0.129893,z:0.229041},{x:-0.956626,y:-0.251149,z:0.147618},{x:-0.931188,y:-0.357738,z:0.070089},{x:-0.354409,y:-0.357742,z:0.863953},{x:-0.436007,y:-0.251152,z:0.864188},{x:-0.515946,y:-0.129894,z:0.846716},{x:-0.587786,y:0,z:0.809017},{x:-0.645839,y:0.129894,z:0.752342},{x:-0.687159,y:0.251152,z:0.681715},{x:-0.71215,y:0.357741,z:0.604039},{x:-0.71215,y:0.357741,z:-0.604039},{x:-0.687159,y:0.251152,z:-0.681715},{x:-0.645839,y:0.129894,z:-0.752343},{x:-0.587786,y:-0,z:-0.809017},{x:-0.515946,y:-0.129894,z:-0.846716},{x:-0.436007,y:-0.251152,z:-0.864188},{x:-0.354409,y:-0.357742,z:-0.863953},{x:-0.931188,y:-0.357738,z:-0.070089},{x:-0.956626,y:-0.251149,z:-0.147618},{x:-0.964711,y:-0.129893,z:-0.229041},{x:-0.951058,y:0,z:-0.309013},{x:-0.915098,y:0.129893,z:-0.381737},{x:-0.860698,y:0.251151,z:-0.442858},{x:-0.794547,y:0.357741,z:-0.490629},{x:0.354409,y:0.357742,z:-0.863953},{x:0.436007,y:0.251152,z:-0.864188},{x:0.515946,y:0.129894,z:-0.846716},{x:0.587786,y:-0,z:-0.809017},{x:0.645839,y:-0.129894,z:-0.752342},{x:0.687159,y:-0.251152,z:-0.681715},{x:0.71215,y:-0.357741,z:-0.604039},{x:-0.221089,y:-0.357741,z:-0.907271},{x:-0.155215,y:-0.251152,z:-0.955422},{x:-0.080276,y:-0.129894,z:-0.988273},{x:0,y:0,z:-1},{x:0.080276,y:0.129894,z:-0.988273},{x:0.155215,y:0.251152,z:-0.955422},{x:0.221089,y:0.357741,z:-0.907271},{x:0.871565,y:0.476984,z:0.113408},{x:0.831051,y:0.502299,z:0.238853},{x:0.769872,y:0.51957,z:0.3706},{x:0.688189,y:0.525736,z:0.499997},{x:0.590366,y:0.519572,z:0.617668},{x:0.483971,y:0.502302,z:0.716565},{x:0.377183,y:0.476988,z:0.793861},{x:0.161465,y:0.476988,z:0.863951},{x:0.029639,y:0.502302,z:0.864184},{x:-0.114564,y:0.519573,z:0.846711},{x:-0.262869,y:0.525738,z:0.809012},{x:-0.405008,y:0.519572,z:0.752338},{x:-0.531941,y:0.502302,z:0.681712},{x:-0.638453,y:0.476987,z:0.604038},{x:-0.771771,y:0.476987,z:0.420539},{x:-0.812729,y:0.502301,z:0.295238},{x:-0.840673,y:0.519571,z:0.152694},{x:-0.850648,y:0.525736,z:-0},{x:-0.840673,y:0.519571,z:-0.152694},{x:-0.812729,y:0.502301,z:-0.295238},{x:-0.771771,y:0.476987,z:-0.420539},{x:-0.638452,y:0.476987,z:-0.604038},{x:-0.531941,y:0.502302,z:-0.681712},{x:-0.405008,y:0.519572,z:-0.752338},{x:-0.262869,y:0.525738,z:-0.809012},{x:-0.114564,y:0.519572,z:-0.846711},{x:0.029639,y:0.502302,z:-0.864184},{x:0.161465,y:0.476988,z:-0.863951},{x:0.377183,y:0.476988,z:-0.793861},{x:0.483971,y:0.502302,z:-0.716565},{x:0.590366,y:0.519572,z:-0.617668},{x:0.688189,y:0.525736,z:-0.499997},{x:0.769872,y:0.51957,z:-0.3706},{x:0.831051,y:0.502299,z:-0.238853},{x:0.871565,y:0.476984,z:-0.113408},{x:0.036848,y:0.992865,z:0.113408},{x:0.077607,y:0.96795,z:0.238853},{x:0.120413,y:0.920955,z:0.370598},{x:0.162456,y:0.850654,z:0.499995},{x:0.200688,y:0.760403,z:0.617666},{x:0.232822,y:0.657519,z:0.716563},{x:0.257937,y:0.550685,z:0.79386},{x:0.834716,y:0.550681,z:0},{x:0.753442,y:0.657515,z:0},{x:0.649456,y:0.760399,z:0},{x:0.52573,y:0.850652,z:0},{x:0.389673,y:0.920953,z:0},{x:0.251147,y:0.967949,z:0},{x:0.119245,y:0.992865,z:0},{x:-0.096471,y:0.992865,z:0.070089},{x:-0.203181,y:0.96795,z:0.147618},{x:-0.315251,y:0.920955,z:0.22904},{x:-0.425323,y:0.850654,z:0.309011},{x:-0.52542,y:0.760403,z:0.381735},{x:-0.609547,y:0.657519,z:0.442856},{x:-0.6753,y:0.550685,z:0.490628},{x:-0.096471,y:0.992865,z:-0.070089},{x:-0.203181,y:0.96795,z:-0.147618},{x:-0.315251,y:0.920955,z:-0.22904},{x:-0.425323,y:0.850654,z:-0.309011},{x:-0.52542,y:0.760403,z:-0.381735},{x:-0.609547,y:0.657519,z:-0.442856},{x:-0.6753,y:0.550685,z:-0.490628},{x:0.036848,y:0.992865,z:-0.113408},{x:0.077607,y:0.96795,z:-0.238853},{x:0.120413,y:0.920955,z:-0.370598},{x:0.162456,y:0.850654,z:-0.499995},{x:0.200688,y:0.760403,z:-0.617666},{x:0.232822,y:0.657519,z:-0.716563},{x:0.257937,y:0.550685,z:-0.79386},{x:0.166198,y:0.978672,z:-0.120749},{x:0.307167,y:0.943208,z:-0.126518},{x:0.215245,y:0.943209,z:-0.253036},{x:0.451375,y:0.882854,z:-0.129731},{x:0.3618,y:0.894429,z:-0.262863},{x:0.262862,y:0.882855,z:-0.389192},{x:0.587783,y:0.798549,z:-0.129731},{x:0.506729,y:0.819912,z:-0.266403},{x:0.409951,y:0.819913,z:-0.399604},{x:0.305014,y:0.798552,z:-0.518924},{x:0.706258,y:0.696558,z:-0.126519},{x:0.638194,y:0.72361,z:-0.262864},{x:0.550008,y:0.733353,z:-0.399605},{x:0.447209,y:0.723612,z:-0.525728},{x:0.338569,y:0.696561,z:-0.632593},{x:0.801022,y:0.586331,z:-0.12075},{x:0.747366,y:0.614342,z:-0.253038},{x:0.672087,y:0.629942,z:-0.389194},{x:0.57783,y:0.629943,z:-0.518926},{x:0.471599,y:0.614344,z:-0.632594},{x:0.362366,y:0.586334,z:-0.724502},{x:-0.063483,y:0.978672,z:-0.195376},{x:-0.025408,y:0.943209,z:-0.331227},{x:-0.174138,y:0.943209,z:-0.282901},{x:0.016098,y:0.882855,z:-0.469369},{x:-0.138197,y:0.89443,z:-0.425319},{x:-0.288916,y:0.882855,z:-0.370262},{x:0.05825,y:0.798552,z:-0.599101},{x:-0.096779,y:0.819914,z:-0.564248},{x:-0.253366,y:0.819914,z:-0.513369},{x:-0.399272,y:0.798552,z:-0.45044},{x:0.097915,y:0.696561,z:-0.710785},{x:-0.05279,y:0.723612,z:-0.688185},{x:-0.210088,y:0.733355,z:-0.646571},{x:-0.361804,y:0.723612,z:-0.587778},{x:-0.497009,y:0.696561,z:-0.517479},{x:0.132684,y:0.586334,z:-0.799129},{x:-0.009708,y:0.614345,z:-0.788978},{x:-0.162463,y:0.629944,z:-0.759458},{x:-0.314971,y:0.629944,z:-0.709904},{x:-0.455902,y:0.614344,z:-0.643998},{x:-0.577066,y:0.586334,z:-0.568513},{x:-0.205432,y:0.978671,z:0},{x:-0.322868,y:0.943208,z:-0.078192},{x:-0.322868,y:0.943208,z:0.078192},{x:-0.441423,y:0.882855,z:-0.160354},{x:-0.44721,y:0.894429,z:0},{x:-0.441423,y:0.882855,z:0.160354},{x:-0.551779,y:0.798551,z:-0.240532},{x:-0.566539,y:0.819912,z:-0.082322},{x:-0.566539,y:0.819912,z:0.082322},{x:-0.551779,y:0.798551,z:0.240532},{x:-0.64574,y:0.696561,z:-0.312768},{x:-0.670817,y:0.723611,z:-0.162457},{x:-0.679848,y:0.733353,z:0},{x:-0.670817,y:0.723611,z:0.162457},{x:-0.64574,y:0.69656,z:0.312768},{x:-0.719015,y:0.586334,z:-0.373135},{x:-0.753363,y:0.614343,z:-0.234576},{x:-0.772492,y:0.629942,z:-0.080177},{x:-0.772492,y:0.629942,z:0.080177},{x:-0.753363,y:0.614343,z:0.234576},{x:-0.719015,y:0.586334,z:0.373135},{x:-0.063483,y:0.978672,z:0.195376},{x:-0.174138,y:0.943209,z:0.282901},{x:-0.025408,y:0.943209,z:0.331227},{x:-0.288916,y:0.882855,z:0.370262},{x:-0.138197,y:0.89443,z:0.425319},{x:0.016098,y:0.882855,z:0.469369},{x:-0.399272,y:0.798552,z:0.45044},{x:-0.253366,y:0.819914,z:0.513369},{x:-0.096779,y:0.819914,z:0.564248},{x:0.05825,y:0.798552,z:0.599101},{x:-0.497009,y:0.696561,z:0.517479},{x:-0.361804,y:0.723612,z:0.587778},{x:-0.210088,y:0.733355,z:0.646571},{x:-0.05279,y:0.723612,z:0.688185},{x:0.097915,y:0.696561,z:0.710785},{x:-0.577066,y:0.586334,z:0.568513},{x:-0.455902,y:0.614345,z:0.643998},{x:-0.314971,y:0.629944,z:0.709904},{x:-0.162463,y:0.629944,z:0.759458},{x:-0.009708,y:0.614345,z:0.788978},{x:0.132684,y:0.586335,z:0.799129},{x:0.166198,y:0.978672,z:0.120749},{x:0.215245,y:0.943209,z:0.253036},{x:0.307167,y:0.943208,z:0.126518},{x:0.262862,y:0.882855,z:0.389192},{x:0.3618,y:0.894429,z:0.262863},{x:0.451375,y:0.882854,z:0.129731},{x:0.305014,y:0.798552,z:0.518924},{x:0.409951,y:0.819913,z:0.399604},{x:0.506729,y:0.819912,z:0.266403},{x:0.587783,y:0.798549,z:0.129731},{x:0.338569,y:0.696561,z:0.632593},{x:0.447209,y:0.723612,z:0.525728},{x:0.550008,y:0.733353,z:0.399605},{x:0.638194,y:0.72361,z:0.262864},{x:0.706258,y:0.696558,z:0.126519},{x:0.362366,y:0.586334,z:0.724502},{x:0.471599,y:0.614344,z:0.632594},{x:0.57783,y:0.629943,z:0.518926},{x:0.672087,y:0.629942,z:0.389194},{x:0.747366,y:0.614342,z:0.253038},{x:0.801022,y:0.586331,z:0.12075},{x:0.90374,y:0.380897,z:-0.195376},{x:0.921508,y:0.266063,z:-0.282902},{x:0.854992,y:0.399094,z:-0.331229},{x:0.918856,y:0.13641,z:-0.370264},{x:0.861804,y:0.276396,z:-0.425322},{x:0.782446,y:0.409229,z:-0.469371},{x:0.892805,y:-0,z:-0.450443},{x:0.84666,y:0.140059,z:-0.513372},{x:0.77663,y:0.280118,z:-0.564251},{x:0.68819,y:0.40923,z:-0.599104},{x:0.84529,y:-0.133032,z:-0.517481},{x:0.809019,y:0,z:-0.587782},{x:0.749882,y:0.140059,z:-0.646576},{x:0.670821,y:0.276397,z:-0.688189},{x:0.579226,y:0.399096,z:-0.710788},{x:0.782501,y:-0.253933,z:-0.568515},{x:0.753368,y:-0.133032,z:-0.644002},{x:0.704293,y:0,z:-0.709909},{x:0.636088,y:0.136411,z:-0.759463},{x:0.55382,y:0.266065,z:-0.788982},{x:0.465085,y:0.3809,z:-0.799132},{x:0.093451,y:0.3809,z:-0.919882},{x:0.0157,y:0.266064,z:-0.963827},{x:-0.050816,y:0.399096,z:-0.9155},{x:-0.068205,y:0.13641,z:-0.988302},{x:-0.138198,y:0.276397,z:-0.951055},{x:-0.204615,y:0.40923,z:-0.889193},{x:-0.152509,y:-0,z:-0.988302},{x:-0.226618,y:0.140059,z:-0.963861},{x:-0.296648,y:0.280118,z:-0.912981},{x:-0.357124,y:0.40923,z:-0.839639},{x:-0.230948,y:-0.133033,z:-0.963829},{x:-0.309016,y:-0,z:-0.951057},{x:-0.383207,y:0.140059,z:-0.912982},{x:-0.447215,y:0.276397,z:-0.850649},{x:-0.497012,y:0.399096,z:-0.77052},{x:-0.298885,y:-0.253934,z:-0.919883},{x:-0.37968,y:-0.133033,z:-0.915503},{x:-0.457527,y:-0,z:-0.889196},{x:-0.525732,y:0.13641,z:-0.839642},{x:-0.579229,y:0.266065,z:-0.770522},{x:-0.616302,y:0.3809,z:-0.689266},{x:-0.845982,y:0.380899,z:-0.373136},{x:-0.911804,y:0.266063,z:-0.312769},{x:-0.886396,y:0.399095,z:-0.234577},{x:-0.961008,y:0.13641,z:-0.240533},{x:-0.947213,y:0.276396,z:-0.162458},{x:-0.908902,y:0.409229,z:-0.080178},{x:-0.987059,y:0,z:-0.160355},{x:-0.986715,y:0.140059,z:-0.082322},{x:-0.959966,y:0.280117,z:0},{x:-0.908902,y:0.409229,z:0.080178},{x:-0.988023,y:-0.133031,z:-0.078192},{x:-1,y:1e-6,z:0},{x:-0.986715,y:0.140059,z:0.082323},{x:-0.947213,y:0.276397,z:0.162458},{x:-0.886395,y:0.399095,z:0.234577},{x:-0.967222,y:-0.253931,z:0},{x:-0.988023,y:-0.13303,z:0.078193},{x:-0.987059,y:1e-6,z:0.160356},{x:-0.961008,y:0.136411,z:0.240534},{x:-0.911803,y:0.266065,z:0.312769},{x:-0.845982,y:0.3809,z:0.373136},{x:-0.616302,y:0.3809,z:0.689266},{x:-0.579229,y:0.266064,z:0.770521},{x:-0.497012,y:0.399096,z:0.77052},{x:-0.525732,y:0.13641,z:0.839641},{x:-0.447216,y:0.276397,z:0.850649},{x:-0.357124,y:0.40923,z:0.839639},{x:-0.457527,y:-1e-6,z:0.889196},{x:-0.383208,y:0.140059,z:0.912982},{x:-0.296649,y:0.280118,z:0.912981},{x:-0.204616,y:0.40923,z:0.889193},{x:-0.379681,y:-0.133033,z:0.915502},{x:-0.309017,y:-1e-6,z:0.951056},{x:-0.226619,y:0.140059,z:0.963861},{x:-0.138199,y:0.276397,z:0.951055},{x:-0.050817,y:0.399096,z:0.9155},{x:-0.298885,y:-0.253934,z:0.919883},{x:-0.230948,y:-0.133033,z:0.963828},{x:-0.152509,y:-0,z:0.988302},{x:-0.068206,y:0.13641,z:0.988302},{x:0.015699,y:0.266064,z:0.963827},{x:0.093451,y:0.3809,z:0.919882},{x:0.465085,y:0.3809,z:0.799132},{x:0.55382,y:0.266064,z:0.788983},{x:0.579226,y:0.399096,z:0.710788},{x:0.636088,y:0.13641,z:0.759463},{x:0.67082,y:0.276396,z:0.68819},{x:0.68819,y:0.409229,z:0.599104},{x:0.704293,y:-1e-6,z:0.709909},{x:0.749882,y:0.140058,z:0.646576},{x:0.77663,y:0.280116,z:0.564252},{x:0.782446,y:0.409228,z:0.469372},{x:0.753368,y:-0.133034,z:0.644002},{x:0.809019,y:-2e-6,z:0.587783},{x:0.846659,y:0.140057,z:0.513373},{x:0.861804,y:0.276394,z:0.425323},{x:0.854992,y:0.399093,z:0.33123},{x:0.782501,y:-0.253934,z:0.568515},{x:0.845289,y:-0.133034,z:0.517482},{x:0.892805,y:-2e-6,z:0.450444},{x:0.918856,y:0.136407,z:0.370266},{x:0.921508,y:0.266061,z:0.282904},{x:0.90374,y:0.380896,z:0.195377},{x:0.298886,y:0.253934,z:-0.919883},{x:0.379681,y:0.133033,z:-0.915502},{x:0.230948,y:0.133033,z:-0.963828},{x:0.457527,y:-0,z:-0.889196},{x:0.309017,y:-0,z:-0.951056},{x:0.152509,y:0,z:-0.988302},{x:0.525732,y:-0.136411,z:-0.839641},{x:0.383207,y:-0.14006,z:-0.912982},{x:0.226619,y:-0.14006,z:-0.963861},{x:0.068205,y:-0.13641,z:-0.988302},{x:0.579229,y:-0.266065,z:-0.770521},{x:0.447216,y:-0.276398,z:-0.850648},{x:0.296648,y:-0.280119,z:-0.91298},{x:0.138199,y:-0.276398,z:-0.951055},{x:-0.015699,y:-0.266065,z:-0.963827},{x:0.616302,y:-0.3809,z:-0.689265},{x:0.497012,y:-0.399097,z:-0.77052},{x:0.357124,y:-0.409231,z:-0.839639},{x:0.204615,y:-0.409231,z:-0.889192},{x:0.050817,y:-0.399097,z:-0.9155},{x:-0.093451,y:-0.3809,z:-0.919881},{x:-0.782501,y:0.253934,z:-0.568515},{x:-0.753368,y:0.133032,z:-0.644002},{x:-0.84529,y:0.133032,z:-0.517482},{x:-0.704293,y:-0,z:-0.70991},{x:-0.809018,y:-0,z:-0.587783},{x:-0.892805,y:0,z:-0.450444},{x:-0.636087,y:-0.136411,z:-0.759464},{x:-0.749881,y:-0.140059,z:-0.646577},{x:-0.846659,y:-0.140059,z:-0.513374},{x:-0.918856,y:-0.13641,z:-0.370265},{x:-0.553819,y:-0.266065,z:-0.788983},{x:-0.670819,y:-0.276397,z:-0.688191},{x:-0.776628,y:-0.280118,z:-0.564253},{x:-0.861803,y:-0.276396,z:-0.425324},{x:-0.921507,y:-0.266063,z:-0.282904},{x:-0.465084,y:-0.3809,z:-0.799132},{x:-0.579224,y:-0.399096,z:-0.710789},{x:-0.688189,y:-0.40923,z:-0.599106},{x:-0.782445,y:-0.409229,z:-0.469374},{x:-0.854991,y:-0.399094,z:-0.331231},{x:-0.903739,y:-0.380897,z:-0.195378},{x:-0.782501,y:0.253934,z:0.568515},{x:-0.84529,y:0.133032,z:0.517482},{x:-0.753368,y:0.133032,z:0.644002},{x:-0.892805,y:-0,z:0.450444},{x:-0.809018,y:0,z:0.587783},{x:-0.704293,y:0,z:0.70991},{x:-0.918856,y:-0.13641,z:0.370265},{x:-0.846659,y:-0.140059,z:0.513374},{x:-0.749881,y:-0.140059,z:0.646577},{x:-0.636087,y:-0.136411,z:0.759464},{x:-0.921508,y:-0.266063,z:0.282904},{x:-0.861803,y:-0.276396,z:0.425324},{x:-0.776629,y:-0.280118,z:0.564253},{x:-0.670819,y:-0.276397,z:0.688191},{x:-0.553819,y:-0.266065,z:0.788983},{x:-0.903739,y:-0.380897,z:0.195378},{x:-0.854991,y:-0.399094,z:0.331231},{x:-0.782445,y:-0.409229,z:0.469374},{x:-0.688189,y:-0.40923,z:0.599106},{x:-0.579224,y:-0.399096,z:0.710789},{x:-0.465084,y:-0.3809,z:0.799132},{x:0.298886,y:0.253934,z:0.919883},{x:0.230948,y:0.133032,z:0.963828},{x:0.379681,y:0.133033,z:0.915502},{x:0.152509,y:-0,z:0.988302},{x:0.309017,y:0,z:0.951056},{x:0.457527,y:0,z:0.889196},{x:0.068206,y:-0.13641,z:0.988302},{x:0.226619,y:-0.14006,z:0.963861},{x:0.383207,y:-0.14006,z:0.912982},{x:0.525732,y:-0.136411,z:0.839641},{x:-0.015699,y:-0.266065,z:0.963827},{x:0.138199,y:-0.276397,z:0.951055},{x:0.296648,y:-0.280119,z:0.91298},{x:0.447216,y:-0.276398,z:0.850648},{x:0.579229,y:-0.266065,z:0.770521},{x:-0.093451,y:-0.3809,z:0.919882},{x:0.050817,y:-0.399097,z:0.9155},{x:0.204615,y:-0.40923,z:0.889192},{x:0.357124,y:-0.40923,z:0.839639},{x:0.497012,y:-0.399097,z:0.77052},{x:0.616302,y:-0.3809,z:0.689266},{x:0.967222,y:0.253931,z:0},{x:0.988023,y:0.133031,z:0.078192},{x:0.988023,y:0.133031,z:-0.078192},{x:0.987059,y:-0,z:0.160355},{x:1,y:0,z:0},{x:0.987059,y:0,z:-0.160355},{x:0.961008,y:-0.13641,z:0.240533},{x:0.986715,y:-0.140059,z:0.082322},{x:0.986715,y:-0.140059,z:-0.082322},{x:0.961008,y:-0.13641,z:-0.240533},{x:0.911804,y:-0.266064,z:0.312769},{x:0.947213,y:-0.276396,z:0.162458},{x:0.959966,y:-0.280117,z:0},{x:0.947213,y:-0.276396,z:-0.162458},{x:0.911804,y:-0.266064,z:-0.312769},{x:0.845982,y:-0.380899,z:0.373136},{x:0.886396,y:-0.399095,z:0.234576},{x:0.908902,y:-0.409229,z:0.080178},{x:0.908902,y:-0.409229,z:-0.080178},{x:0.886396,y:-0.399095,z:-0.234576},{x:0.845982,y:-0.380899,z:-0.373136},{x:0.577066,y:-0.586334,z:-0.568513},{x:0.497009,y:-0.696561,z:-0.517479},{x:0.455902,y:-0.614344,z:-0.643999},{x:0.399272,y:-0.798552,z:-0.450441},{x:0.361804,y:-0.723612,z:-0.587779},{x:0.314971,y:-0.629943,z:-0.709905},{x:0.288916,y:-0.882855,z:-0.370263},{x:0.253366,y:-0.819913,z:-0.51337},{x:0.210087,y:-0.733354,z:-0.646572},{x:0.162463,y:-0.629943,z:-0.759459},{x:0.174138,y:-0.943209,z:-0.282902},{x:0.138197,y:-0.894429,z:-0.425321},{x:0.096779,y:-0.819912,z:-0.56425},{x:0.052789,y:-0.723611,z:-0.688186},{x:0.009708,y:-0.614344,z:-0.788979},{x:0.063482,y:-0.978671,z:-0.195377},{x:0.025407,y:-0.943208,z:-0.331229},{x:-0.016099,y:-0.882854,z:-0.469371},{x:-0.05825,y:-0.79855,z:-0.599103},{x:-0.097915,y:-0.69656,z:-0.710786},{x:-0.132684,y:-0.586334,z:-0.799129},{x:-0.362367,y:-0.586334,z:-0.724501},{x:-0.338569,y:-0.696561,z:-0.632593},{x:-0.471601,y:-0.614344,z:-0.632593},{x:-0.305014,y:-0.798552,z:-0.518923},{x:-0.447211,y:-0.723612,z:-0.525727},{x:-0.577832,y:-0.629943,z:-0.518924},{x:-0.262862,y:-0.882855,z:-0.389192},{x:-0.409952,y:-0.819913,z:-0.399603},{x:-0.55001,y:-0.733353,z:-0.399603},{x:-0.672088,y:-0.629942,z:-0.389192},{x:-0.215245,y:-0.943209,z:-0.253036},{x:-0.361801,y:-0.894429,z:-0.262863},{x:-0.50673,y:-0.819912,z:-0.266402},{x:-0.638195,y:-0.723609,z:-0.262863},{x:-0.747367,y:-0.614341,z:-0.253036},{x:-0.166198,y:-0.978671,z:-0.120749},{x:-0.307168,y:-0.943208,z:-0.126518},{x:-0.451376,y:-0.882853,z:-0.12973},{x:-0.587784,y:-0.798549,z:-0.12973},{x:-0.706258,y:-0.696557,z:-0.126518},{x:-0.801022,y:-0.58633,z:-0.120749},{x:-0.801022,y:-0.58633,z:0.12075},{x:-0.706258,y:-0.696558,z:0.126518},{x:-0.747367,y:-0.614341,z:0.253037},{x:-0.587784,y:-0.798549,z:0.129731},{x:-0.638195,y:-0.723609,z:0.262864},{x:-0.672088,y:-0.629941,z:0.389193},{x:-0.451375,y:-0.882853,z:0.129731},{x:-0.50673,y:-0.819911,z:0.266403},{x:-0.550009,y:-0.733352,z:0.399605},{x:-0.577832,y:-0.629942,z:0.518925},{x:-0.307168,y:-0.943208,z:0.126519},{x:-0.361801,y:-0.894428,z:0.262864},{x:-0.409952,y:-0.819912,z:0.399605},{x:-0.447211,y:-0.72361,z:0.525729},{x:-0.471601,y:-0.614343,z:0.632594},{x:-0.166198,y:-0.978671,z:0.12075},{x:-0.215246,y:-0.943208,z:0.253038},{x:-0.262863,y:-0.882854,z:0.389194},{x:-0.305015,y:-0.79855,z:0.518925},{x:-0.338569,y:-0.69656,z:0.632594},{x:-0.362367,y:-0.586333,z:0.724502},{x:0.719015,y:-0.586334,z:-0.373135},{x:0.753363,y:-0.614343,z:-0.234576},{x:0.64574,y:-0.69656,z:-0.312768},{x:0.772493,y:-0.629942,z:-0.080177},{x:0.670817,y:-0.723611,z:-0.162457},{x:0.55178,y:-0.798551,z:-0.240532},{x:0.772493,y:-0.629942,z:0.080178},{x:0.679849,y:-0.733353,z:0},{x:0.56654,y:-0.819912,z:-0.082322},{x:0.441423,y:-0.882854,z:-0.160354},{x:0.753364,y:-0.614343,z:0.234576},{x:0.670818,y:-0.72361,z:0.162458},{x:0.566541,y:-0.819911,z:0.082323},{x:0.447211,y:-0.894428,z:1e-6},{x:0.322869,y:-0.943208,z:-0.078191},{x:0.719016,y:-0.586333,z:0.373136},{x:0.645741,y:-0.696559,z:0.312769},{x:0.551781,y:-0.79855,z:0.240533},{x:0.441424,y:-0.882854,z:0.160356},{x:0.32287,y:-0.943208,z:0.078193},{x:0.205432,y:-0.978671,z:1e-6},{x:-0.132684,y:-0.586334,z:0.799129},{x:-0.097915,y:-0.696561,z:0.710785},{x:0.009709,y:-0.614344,z:0.788978},{x:-0.058249,y:-0.798552,z:0.599101},{x:0.05279,y:-0.723612,z:0.688185},{x:0.162463,y:-0.629944,z:0.759458},{x:-0.016097,y:-0.882855,z:0.46937},{x:0.09678,y:-0.819913,z:0.564249},{x:0.210089,y:-0.733354,z:0.646572},{x:0.314971,y:-0.629943,z:0.709905},{x:0.025409,y:-0.943209,z:0.331228},{x:0.138199,y:-0.894429,z:0.425321},{x:0.253368,y:-0.819912,z:0.51337},{x:0.361805,y:-0.723611,z:0.587779},{x:0.455903,y:-0.614344,z:0.643999},{x:0.063484,y:-0.978671,z:0.195377},{x:0.17414,y:-0.943208,z:0.282902},{x:0.288918,y:-0.882854,z:0.370264},{x:0.399274,y:-0.79855,z:0.450441},{x:0.497011,y:-0.69656,z:0.51748},{x:0.577067,y:-0.586333,z:0.568513}],kd_tree_points_with_index=kd_tree_sample_points.map((N,O)=>{return N.index=O,N}),H.exports.length=kd_tree_points_with_index.length,H.exports.tree=new F.kdTree(kd_tree_points_with_index,V.euclideanDist,["x","y","z"])},{"./kd-tree-javascript/kdTree.js":5,"./utils.js":9}],8:[function(S,H){function V(ae,ye,xe,ze,re,oe){function se(Ce,Se,qe,Me){var Re=(Ce+qe)*oe+(Se+Me),Pe=Ce*oe+Se,He=[(ye[4*Re+0]-ye[4*Pe+0])/255,(ye[4*Re+1]-ye[4*Pe+1])/255,(ye[4*Re+2]-ye[4*Pe+2])/255].reduce((Te,Ue)=>Te+Ue*Ue,0)+be;return 2*fe/He}var le=re*oe,de=new Float32Array(ze);sum2=new Float32Array(ze),pCount=new Uint32Array(ze);for(var ge=0;ge<le;++ge){var he=xe[ge],pe=ae[ge];de[he]+=pe,sum2[he]+=pe*pe,pCount[he]++}for(var ue=new Float32Array(ze),ge=0;ge<ze;++ge){var me=de[ge]/pCount[ge],ce=sum2[ge]/pCount[ge]-me*me;ue[ge]=0==ce?0:1/ce}for(var fe=0.1,be=1e-6,we=new Float32Array(5*le),Ie=new Float32Array(le),ge=0,ve=0;ge<re;++ge)for(var _e,ke=0;ke<oe;++ke,++ve)_e=ue[xe[ve]],Ie[ve]=_e,we[5*ve+4]=_e;for(var ge=1,ve=oe;ge<re;++ge)for(var _e,ke=0;ke<oe;++ke,++ve)_e=se(ge,ke,-1,0),we[5*ve]=-_e,we[5*ve+4]+=_e;for(var ge=0,ve=1;ge<re;++ge,++ve)for(var _e,ke=1;ke<oe;++ke,++ve)_e=se(ge,ke,0,-1),we[5*ve+1]=-_e,we[5*ve+4]+=_e;for(var ge=0,ve=0;ge<re;++ge,++ve)for(var _e,ke=0;ke<oe-1;++ke,++ve)_e=se(ge,ke,0,1),we[5*ve+2]=-_e,we[5*ve+4]+=_e;for(var ge=0,ve=0;ge<re-1;++ge)for(var _e,ke=0;ke<oe;++ke,++ve)_e=se(ge,ke,1,0),we[5*ve+3]=-_e,we[5*ve+4]+=_e;for(var Ee=0,je=0,Be=0,ge=0;ge<we.length;++ge)je+=we[ge],Be+=we[ge]*we[ge],Ee=Math.max(Ee,Math.abs(we[ge]));je/=we.length,Ee=Math.sqrt(Be/we.length-je*je)/Math.SQRT1_2;for(var Le=1,ge=0;ge<we.length;++ge)we[ge]*=Le;for(var De=new Float32Array(le),ge=0;ge<le;++ge)De[ge]=Ie[ge]*ae[ge]*Le;return F(we,De,ae,300,re,oe),ae}function F(ae,ye,xe,ze,re,oe){var se=Q(ae,oe);O(ae,xe,ye,se,ze,re,oe)}function O(ae,ye,xe,ze,re,oe,se){var le=new Float32Array(xe.length),de=new Float32Array(xe.length),ge=new Float32Array(xe.length),he=new Float32Array(xe.length),pe=new Float32Array(xe.length),ue=0,me=0;X(he,ye,ae,oe,se),Y(le,xe,he),J(de,ze,le,se),ge=de.slice(0),me=ee(de,le),ue=me;var ce=new Float32Array(xe.length);J(ce,ze,xe,se);for(var fe=ee(ce,ce),be=new Date,we=0;we<re;++we){X(pe,ge,ae,oe,se);var Ie=0.9*ue/ee(pe,ge);te(1,ye,Ie,ge),te(1,le,-Ie,pe);var ve=ee(le,le)/le.length,ke=new Date;if(1e3<ke-be&&(self.postMessage({signal:"Smoothing with PCG.  Error: "+ve}),be=ke),0.2>ve)break;J(de,ze,le,se),ue=ee(de,le);var _e=ue/me;te(_e,ge,1,de),me=ue}}function Q(ae,ye){for(var xe=ae.slice(0),ze=ae.length/5,re=0;re<ze-ye;++re){var oe=5*re,se=1/xe[oe+4],le=xe[oe+2]*se,de=xe[oe+3]*se;xe[oe+9]-=le*xe[oe+2];var ge=Math.abs(de*xe[oe+2]);xe[oe+9]+=ge,xe[oe+5*ye+4]+=ge,xe[oe+5*ye+4]-=de*xe[oe+3]}for(var re=ze-ye;re<ze-1;++re){var oe=5*re,se=1/xe[oe+4],le=xe[oe+2]*se;xe[oe+9]-=le*xe[oe+2]}for(var re=1;re<ze;++re)xe[5*re+1]=xe[5*re-3];for(var re=ye;re<ze;++re)xe[5*re]=xe[5*(re-ye)+3];return xe}function J(ae,ye,xe,ze){var re=ae.length;ae[0]=xe[0]/ye[4];for(var oe=1;oe<ze;++oe)ae[oe]=(xe[oe]-ye[5*oe+1]*ae[oe-1])/ye[5*oe+4];for(var oe=ze;oe<re;++oe)ae[oe]=(xe[oe]-ye[5*oe]*ae[oe-ze]-ye[5*oe+1]*ae[oe-1])/ye[5*oe+4];for(var oe=0;oe<re;++oe)ae[oe]*=ye[5*oe+4];ae[re-1]/=ye[5*re-1];for(var oe=re-2;oe>re-1-ze;--oe)ae[oe]=(ae[oe]-ye[5*oe+2]*ae[oe+1])/ye[5*oe+4];for(var oe=re-1-ze;0<=oe;--oe)ae[oe]=(ae[oe]-ye[5*oe+3]*ae[oe+ze]-ye[5*oe+2]*ae[oe+1])/ye[5*oe+4]}function X(ae,ye,xe,ze,re){ae.fill(0);for(var oe=0,se=re;oe<ye.length-re;++oe,++se)ae[se]+=xe[5*se]*ye[oe];for(var oe=0,le=0;oe<ze;++oe,++le)for(var se=0;se<re-1;++se,++le)ae[le+1]+=xe[5*le+5+1]*ye[le];for(var oe=0,le=1;oe<ze;++oe,++le)for(var se=1;se<re;++se,++le)ae[le-1]+=xe[5*le-5+2]*ye[le];for(var oe=re,se=0;oe<ye.length;++oe,++se)ae[se]+=xe[5*se+3]*ye[oe];for(var oe=0;oe<ye.length;++oe)ae[oe]+=xe[5*oe+4]*ye[oe]}function Y(ae,ye,xe){for(var ze=0;ze<ye.length;++ze)ae[ze]=ye[ze]-xe[ze]}function ee(ae,ye){for(var xe=0,ze=0;ze<ae.length;++ze)xe+=ae[ze]*ye[ze];return xe}function te(ae,ye,xe,ze){for(var re=0;re<ye.length;++re)ye[re]=ae*ye[re]+xe*ze[re]}var ie=S("./sample_642.js"),ne=ie.tree;transmittanceMap=function(ae,ye,xe,ze){var re=ye*xe,oe=ae,se=ie.length,le=new Uint16Array(re),de=new Uint16Array(re),ge=new Float32Array(se),he=new Float32Array(re),pe=new Float32Array(2*re);self.postMessage({signal:"Clustering points\u2026"});for(var ue=0,me=0;me<re;++me){var ce=[oe[4*me]/255-ze[0],oe[4*me+1]/255-ze[1],oe[4*me+2]/255-ze[2]],fe=Math.sqrt(ce[0]*ce[0]+ce[1]*ce[1]+ce[2]*ce[2]);he[me]=fe;var be={x:ce[0]/fe,y:ce[1]/fe,z:ce[2]/fe},we=ne.nearest(be,2,0.4),Ie=we[1][0].index,ve=we[0][0].index;le[me]=Ie,ue=Math.max(we[0][1],ue),ge[Ie]=Math.max(ge[Ie],fe),(0.01>we[0][1]-we[1][1]||0==ge[ve])&&(ge[ve]=Math.max(ge[ve],fe)),de[me]=we[0][0].index,pe[2*me]=we[1][1],pe[2*me+1]=we[0][1]}self.postMessage({signal:"Calculating raw transmittance\u2026"});for(var ke=[255,255,255],me=0;me<4*re;me+=4)ke[0]=Math.min(ke[0],oe[me]),ke[1]=Math.min(ke[1],oe[me+1]),ke[2]=Math.min(ke[2],oe[me+2]);for(var _e=1,me=0;3>me;++me)_e=Math.min(_e,1-ke[me]/(255*ze[me]));for(var Ee=new Float32Array(re),me=0,je=0;me<xe;++me)for(var Be=0;Be<ye;++Be,++je){var Le=_e*he[je]/ge[le[je]],De=_e*he[je]/ge[de[je]],Ce=pe[2*je]+pe[2*je+1],Se=Le*pe[2*je+1]+De*pe[2*je];Se/=Ce;var qe=Math.min(oe[4*je+0]/255/ze[0],oe[4*je+1]/255/ze[1],oe[4*je+2]/255/ze[2]);Ee[je]=Math.max(Se,1-qe)}if(2e6<Ee.length)for(var Me=Math.floor(3e5/ye),Re=Math.ceil(xe/Me),Pe=Me*ye,He=0,me=1;He<re;He+=Pe,++me){self.postMessage({signal:"Dehazing image: block: "+me+" / "+Re});var Ae=He+Pe<xe*ye?Pe:xe*ye-He,Te=new Float32Array(Ee.buffer,4*He,Ae),Ue=new Uint8ClampedArray(oe.buffer,4*He,4*Ae),Ve=new Uint16Array(le.buffer,2*He,Ae);V(Te,Ue,Ve,se,Ae/ye,ye)}return self.postMessage({signal:"Finalizing transmittance map\u2026"}),V(Ee,oe,le,se,xe,ye),Ee},H.exports=transmittanceMap},{"./sample_642.js":7}],9:[function(S,H){function Q($){return[...Array($).keys()]}flatten=function($,ee=[]){for(let te=0,ie=$.length;te<ie;te++){const ne=$[te];Array.isArray(ne)?flatten(ne,ee):ee.push(ne)}return ee},H.exports.makeColorArray=function($,ee=!1){var te=$.getContext("2d"),ie=Array.from(te.getImageData(0,0,$.width,$.height).data);ee&&ie.map(ye=>ye/255);for(var ne=Array(Math.ceil(ie.length/4)).fill(),ae=0;ae<ne.length;++ae)ne[ae]=[ie[4*ae],ie[4*ae+1],ie[4*ae+2]];return ne},H.exports.arange=function($,ee,te){for(var ie=Math.floor((te-$)/ee)+1,ne=new Float32Array(ie),ae=0;ae<ie;++ae)ne[ae]=$+ae*ee;return ne},H.exports.linRange=function($,ee,te){for(var ne=new Float32Array(ee),ae=0;ae<ee;++ae)ne[ae]=$+ae*((te-$)/(ee-1));return ne},H.exports.cartesian=function($,ee){return[].concat(...$.map(te=>ee.map(ie=>[te,ie])))},H.exports.range=function($,ee){return[...Array(ee-$).keys()].map(ie=>ie+$)},H.exports.list2dict3D=function($){var ee=$.map(te=>{return{x:te[0],y:te[1],z:te[2]}});return ee},H.exports.dict2list3D=function($){return $.map(ee=>[ee.x,ee.y,ee.z])},H.exports.euclideanDist=function($,ee){var te={x:$.x-ee.x,y:$.y-ee.y,z:$.z-ee.z};return Math.sqrt(te.x*te.x+te.y*te.y+te.z*te.z)},H.exports.angleDist=function($,ee){var te=$.x*ee.x+$.y*ee.y+$.z*ee.z;return te=Math.max(-1,Math.min(te,1)),2*(Math.acos(te)/Math.PI)},H.exports.flatten=flatten,H.exports.cloneCanvas=function($){var ee=document.createElement("canvas"),te=ee.getContext("2d");return ee.width=$.width,ee.height=$.height,te.drawImage($,0,0),ee}},{}],10:[function(S){var V=S("./functions/gui_utils.js"),F=V.processImage,N=V.sliderChange,O=V.changeGamma,Q=V.dehazePreview,G=V.drawDehazed,J=V.mixHaze,K=V.calculateOriginal;window.onload=function(){var X=document.getElementById("fileInput"),Y=document.getElementById("fileDisplayArea");X.addEventListener("change",function(){var he=X.files[0],pe=/image.*/;if(he.type.match(pe)){var ue=new FileReader;ue.readAsDataURL(he),ue.onload=function(){document.getElementById("airLightSection").style.visibility="visible",document.getElementById("transmittanceDiv").style.visibility="hidden",Y.innerHTML="";var ce=new Image;ce.src=ue.result,ce.onload=function(){F(ce)}}}else Y.innerHTML="File not supported!"});var $=document.getElementById("gammaSlide"),ee=document.getElementById("gammaVal");$.addEventListener("input",function(){N(this,ee);var he=document.getElementById("originalPic");O(window.origCanvas,he,new Number(this.value))}),ee.innerHTML=$.value;var te=document.getElementById("minAirSlide"),ie=document.getElementById("minAirVal"),ne=document.getElementById("maxAirSlide"),ae=document.getElementById("maxAirVal");te.addEventListener("input",function(){ne.value-0.05<this.value&&(this.value=ne.value-0.05),N(this,ie)}),ie.innerHTML=te.value,ne.addEventListener("input",function(){te.value>this.value-0.05&&(this.value=new Number(te.value)+0.05),N(this,ae)}),ae.innerHTML=ne.value;var ye=document.getElementById("dehazePreviewButton");ye.addEventListener("click",function(){Q()});var xe=document.getElementById("distSlide"),ze=document.getElementById("distVal"),re=document.getElementById("hazeAmountSlide"),oe=document.getElementById("hazeAmountVal"),se=document.getElementById("gammaOutSlide"),le=document.getElementById("gammaOutVal");xe.addEventListener("input",function(){oninput=N(this,ze);var he=document.getElementById("originalPic"),pe=document.getElementById("dehazeResult");G(he,pe,window.transmittance,window.airLight)}),ze.innerHTML=xe.value,re.addEventListener("input",function(){N(this,oe);var he=window.origCanvas;J(window.dehazeFlat,he.width,he.height,window.dehazedCanvas,window.transmittance,window.airLight,new Number(this.value));var pe=new Number(document.getElementById("gammaOutSlide").value);he=document.getElementById("dehazeResult"),O(window.dehazedCanvas,he,1/pe)}),oe.innerHTML=re.value,se.addEventListener("input",function(){N(this,le);var he=document.getElementById("dehazeResult");O(window.dehazedCanvas,he,1/new Number(this.value))}),le.innerHTML=se.value;var de=document.getElementById("originalButton");de.addEventListener("click",function(){K()})}},{"./functions/gui_utils.js":3}],11:[function(S,H){var V=arguments[3],F=arguments[4],N=arguments[5],O=JSON.stringify;H.exports=function(Q,G){function J(le){for(var de in ye[le]=!0,F[le][1]){var ge=F[le][1][de];ye[ge]||J(ge)}}for(var K,X=Object.keys(N),Y=0,$=X.length;Y<$;Y++){var ee=X[Y],te=N[ee].exports;if(te===Q||te&&te.default===Q){K=ee;break}}if(!K){K=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var ee,ie={},Y=0,$=X.length;Y<$;Y++)ee=X[Y],ie[ee]=ee;F[K]=["function(require,module,exports){"+Q+"(self); }",ie]}var ne=Math.floor(Math.pow(16,8)*Math.random()).toString(16),ae={};ae[K]=K,F[ne]=["function(require,module,exports){var f = require("+O(K)+");(f.default ? f.default : f)(self);}",ae];var ye={};J(ne);var xe="("+V+")({"+Object.keys(ye).map(function(le){return O(le)+":["+F[le][0]+","+O(F[le][1])+"]"}).join(",")+"},{},["+O(ne)+"])",ze=window.URL||window.webkitURL||window.mozURL||window.msURL,re=new Blob([xe],{type:"text/javascript"});if(G&&G.bare)return re;var oe=ze.createObjectURL(re),se=new Worker(oe);return se.objectURL=oe,se}},{}],12:[function(S,H){var V=S("../functions/min-variance-quantization.js"),F=S("../functions/airlight.js"),N=S("../functions/transmittance.js");H.exports=function(O){onmessage=function(Q){var G=Q.data,J=G.clusters,K=G.image,X=G.minEst,Y=G.maxEst,$=G.picWidth,ee=G.picHeight,te=new Date;O.postMessage({signal:"Finding air light\u2026"});var ie=new V(K.slice(0),J),ne=new Date;console.log("Finished quantization in "+(ne-te)/1e3+" secs.");var ae=F(K,ie,X,Y);ne=new Date,console.log("Finished air light in "+(ne-te)/1e3+" secs."),O.postMessage({signal:"Finding transmittance map\u2026"});var ye=N(K,$,ee,ae);O.postMessage({signal:"finish",airLight:ae,transmittance:ye},[ye.buffer]),O.close()}}},{"../functions/airlight.js":2,"../functions/min-variance-quantization.js":6,"../functions/transmittance.js":8}],13:[function(S,H){var V=S("../functions/min-variance-quantization.js"),F=S("../functions/airlight.js");H.exports=function(N){onmessage=function(O){for(var Q=O.data,G=Q.clusters,J=Q.image,K=Q.minEst,X=Q.maxEst,Y=new Date,$=Array(Math.ceil(J.length/4)).fill(),ee=0;ee<$.length;++ee)$[ee]=[J[4*ee],J[4*ee+1],J[4*ee+2]];var te=new V($.slice(0),G),ie=new Date;console.log("Finished quantization in "+(ie-Y)/1e3+" secs.");var ne=F($,te,K,X);ie=new Date,console.log("Finished air light in "+(ie-Y)/1e3+" secs."),N.postMessage(ne),N.close()}}},{"../functions/airlight.js":2,"../functions/min-variance-quantization.js":6}],14:[function(S,H){var V=S("../functions/transmittance.js");H.exports=function(F){onmessage=function(N){var O=N.data,Q=O.colorArray,G=O.picWidth,J=O.picHeight,K=O.airLight,X=V(Q,G,J,K);F.postMessage({signal:"finish",transmittance:X},[X.buffer]),F.close()}}},{"../functions/transmittance.js":8}]},{},[10]);